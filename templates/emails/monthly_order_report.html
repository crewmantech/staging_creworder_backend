<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Monthly Order Report</title>
</head>

<body style="margin:0;padding:0;background:#e9edf3;font-family:'Segoe UI',Arial,sans-serif;">

<table width="100%" cellpadding="0" cellspacing="0" style="background:#e9edf3;padding:30px 10px;">
<tr>
<td align="center">

<!-- MAIN CONTAINER -->
<table width="900" cellpadding="0" cellspacing="0"
       style="background:#ffffff;border-radius:10px;overflow:hidden;
              box-shadow:0 8px 20px rgba(0,0,0,0.12);">

    <!-- HEADER -->
    <tr>
        <td style="background:linear-gradient(90deg,#2f80ed,#1c5fd4);
                   padding:25px;color:#ffffff;">
            <h2 style="margin:0;font-weight:600;">ðŸ“Š Monthly Order Report</h2>
            <p style="margin:6px 0 0;font-size:14px;opacity:0.9;">
                {{ company_name }} &nbsp;|&nbsp; {{ start_date }} â†’ {{ end_date }}
            </p>
        </td>
    </tr>

    <!-- BODY -->
    <tr>
        <td style="padding:30px;">

            <!-- DELIVERED SUMMARY CARD -->
            <table width="100%" cellpadding="0" cellspacing="0"
                   style="margin-bottom:30px;">
            <tr>
                <td style="background:#f1f8ff;border-left:6px solid #2f80ed;
                           padding:20px;border-radius:6px;">
                    <h3 style="margin:0 0 10px;color:#2f80ed;">
                        âœ… Delivered Orders Summary
                    </h3>

                    {% for s in status_summary %}
                    {% if s.status == "DELIVERED" %}
                    <table width="100%" cellpadding="10" cellspacing="0"
                           style="border-collapse:collapse;font-size:15px;">
                        <tr>
                            <td><b>Delivered Orders</b></td>
                            <td align="right"><b>{{ s.orders }}</b></td>
                        </tr>
                        <tr>
                            <td><b>Delivered Amount</b></td>
                            <td align="right">â‚¹ {{ s.amount }}</td>
                        </tr>
                        <tr>
                            <td><b>Delivered Gross Amount</b></td>
                            <td align="right">â‚¹ {{ s.amount }}</td>
                        </tr>
                    </table>
                    {% endif %}
                    {% endfor %}
                </td>
            </tr>
            </table>

            <!-- STATUS SUMMARY -->
            <h3 style="margin-bottom:10px;color:#333;">ðŸ“Š Status-wise Summary</h3>

            <table width="100%" cellpadding="12" cellspacing="0"
                   style="border-collapse:collapse;
                          border-radius:6px;overflow:hidden;
                          margin-bottom:35px;">

                <tr style="background:#f4f6fa;color:#333;">
                    <th align="left">Status</th>
                    <th align="right">Orders</th>
                    <th align="right">Amount</th>
                </tr>

                {% for s in status_summary %}
                {% if s.status == "Pending" or s.status == "Accepted" or s.status == "OUT FOR DELIVERY" or s.status == "DELIVERED" or s.status == "RTO INITIATED" or s.status == "RTO DELIVERED" %}
                <tr style="border-bottom:1px solid #e5e9f0;">
                    <td>
                        <span style="
                            padding:4px 10px;
                            border-radius:12px;
                            font-size:12px;
                            background:
                                {% if s.status == 'DELIVERED' %}#e8f8f0{% elif s.status == 'Pending' %}#fff4e5{% elif s.status == 'OUT FOR DELIVERY' %}#e6f0ff{% elif 'RTO' in s.status %}#fdeaea{% else %}#f1f1f1{% endif %};
                            color:
                                {% if s.status == 'DELIVERED' %}#1b7f4b{% elif s.status == 'Pending' %}#b26a00{% elif s.status == 'OUT FOR DELIVERY' %}#1c5fd4{% elif 'RTO' in s.status %}#b42318{% else %}#333{% endif %};
                        ">
                            {{ s.status }}
                        </span>
                    </td>
                    <td align="right">{{ s.orders }}</td>
                    <td align="right">â‚¹ {{ s.amount }}</td>
                </tr>
                {% endif %}
                {% endfor %}
            </table>

            <!-- USER STATUS MATRIX -->
            <h3 style="margin-bottom:10px;color:#333;">
                {% if role == "ADMIN" %}
                    ðŸ‘¥ Company User Performance Matrix
                {% else %}
                    ðŸ‘¥ Team User Performance Matrix
                {% endif %}
            </h3>

            <table width="100%" cellpadding="12" cellspacing="0"
                   style="border-collapse:collapse;
                          border-radius:6px;
                          overflow:hidden;
                          font-size:14px;">

                <tr style="background:#2f80ed;color:#ffffff;">
                    <th align="left">Agent</th>
                    <th>Pending</th>
                    <th>Accepted</th>
                    <th>OFD</th>
                    <th>Delivered</th>
                    <th>RTO Init</th>
                    <th>RTO Del</th>
                    <th>Total</th>
                </tr>

                {% for u in user_wise %}
                <tr style="border-bottom:1px solid #e5e9f0;">
                    <td>
                        <b>{{ u.name }}</b><br>
                        <small style="color:#777;">{{ u.username }}</small>
                    </td>

                    <td align="center">{% for us in u.statuses %}{% if us.status == "Pending" %}{{ us.orders }}{% endif %}{% empty %}0{% endfor %}</td>
                    <td align="center">{% for us in u.statuses %}{% if us.status == "Accepted" %}{{ us.orders }}{% endif %}{% empty %}0{% endfor %}</td>
                    <td align="center">{% for us in u.statuses %}{% if us.status == "OUT FOR DELIVERY" %}{{ us.orders }}{% endif %}{% empty %}0{% endfor %}</td>
                    <td align="center" style="font-weight:bold;color:#1b7f4b;">
                        {% for us in u.statuses %}{% if us.status == "DELIVERED" %}{{ us.orders }}{% endif %}{% empty %}0{% endfor %}
                    </td>
                    <td align="center">{% for us in u.statuses %}{% if us.status == "RTO INITIATED" %}{{ us.orders }}{% endif %}{% empty %}0{% endfor %}</td>
                    <td align="center">{% for us in u.statuses %}{% if us.status == "RTO DELIVERED" %}{{ us.orders }}{% endif %}{% empty %}0{% endfor %}</td>

                    <td align="center" style="font-weight:bold;background:#f5f7fb;">
                        {{ u.total_orders }}
                    </td>
                </tr>
                {% endfor %}
            </table>

        </td>
    </tr>

    <!-- FOOTER -->
    <tr>
        <td style="background:#f4f6fa;padding:15px;text-align:center;
                   color:#777;font-size:12px;">
            This is an auto-generated report â€¢ Please do not reply
        </td>
    </tr>

</table>

</td>
</tr>
</table>

</body>
</html>
