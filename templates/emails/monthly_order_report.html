<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Monthly Order Report</title>
</head>

<body style="margin:0;padding:0;background:#eef1f5;font-family:Arial, Helvetica, sans-serif;">

<table width="100%" cellpadding="0" cellspacing="0" style="background:#eef1f5;padding:20px;">
<tr>
<td align="center">

<!-- MAIN CARD -->
<table width="900" cellpadding="0" cellspacing="0"
       style="background:#ffffff;border-radius:8px;overflow:hidden;
              box-shadow:0 4px 12px rgba(0,0,0,0.08);">

    <!-- HEADER -->
    <tr>
        <td style="background:#2f80ed;padding:20px;color:#ffffff;">
            <h2 style="margin:0;">ðŸ“Š Monthly Order Report</h2>
            <p style="margin:5px 0 0;font-size:14px;">
                {{ company_name }} | {{ start_date }} â†’ {{ end_date }}
            </p>
        </td>
    </tr>

    <!-- BODY -->
    <tr>
        <td style="padding:25px;">

            <!-- OVERALL SUMMARY -->
            <h3 style="color:#333;">ðŸ“Œ Overall Summary</h3>

            <table width="100%" cellpadding="12" cellspacing="0"
                   style="border-collapse:collapse;margin-bottom:25px;">
                <tr style="background:#f7f9fc;">
                    <td><b>Total Orders</b></td>
                    <td align="right">{{ summary.total_orders }}</td>
                </tr>
                {% for s in status_summary %}
                {% if s.status == "DELIVERED" %}
                <tr style="background:#f7f9fc;">
                    <td><b>Delivered Orders</b></td>
                    <td align="right">{{ s.orders }}</td>
                </tr>
                <tr>
                    <td><b>Total Delivered Amount</b></td>
                    <td align="right">â‚¹ {{ s.amount }}</td>
                </tr>
                <tr style="background:#f7f9fc;">
                    <td><b>Total Delivered Discount</b></td>
                    <td align="right">â‚¹ 0</td>
                </tr>
                <tr>
                    <td><b>Total Delivered Gross Amount</b></td>
                    <td align="right">â‚¹ {{ s.amount }}</td>
                </tr>
                {% endif %}
                {% endfor %}
                <!-- <tr>
                    <td><b>Total Amount</b></td>
                    <td align="right">â‚¹ {{ summary.total_amount }}</td>
                </tr>
                <tr style="background:#f7f9fc;">
                    <td><b>Total Discount</b></td>
                    <td align="right">â‚¹ {{ summary.total_discount }}</td>
                </tr>
                <tr>
                    <td><b>Gross Amount</b></td>
                    <td align="right">â‚¹ {{ summary.total_gross_amount }}</td>
                </tr> -->
            </table>

            <!-- STATUS SUMMARY -->
            <h3 style="color:#333;">ðŸ“Š Status-wise Summary</h3>

            <table width="100%" cellpadding="10" cellspacing="0"
                   style="border-collapse:collapse;margin-bottom:30px;">
                <tr style="background:#e8f0fe;">
                    <th align="left">Status</th>
                    <th align="right">Orders</th>
                    <th align="right">Amount</th>
                </tr>

                {% for s in status_summary %}
                {% if s.status == "Pending" or s.status == "Accepted" or s.status == "OUT FOR DELIVERY" or s.status == "DELIVERED" or s.status == "RTO INITIATED" or s.status == "RTO DELIVERED" %}
                <tr>
                    <td>{{ s.status }}</td>
                    <td align="right">{{ s.orders }}</td>
                    <td align="right">â‚¹ {{ s.amount }}</td>
                </tr>
                {% endif %}
                {% endfor %}
            </table>

            <!-- USER MATRIX -->
            <h3 style="color:#333;">
                {% if role == "ADMIN" %}
                    ðŸ‘¥ Company User-wise Status Matrix
                {% else %}
                    ðŸ‘¥ Team User-wise Status Matrix
                {% endif %}
            </h3>

            <table width="100%" cellpadding="10" cellspacing="0"
                   style="border-collapse:collapse;font-size:14px;margin-top:10px;">

                <!-- MATRIX HEADER -->
                <tr style="background:#2f80ed;color:#ffffff;">
                    <th align="left">Agent</th>
                    <th align="center">Pending</th>
                    <th align="center">Accepted</th>
                    <th align="center">OUT FOR DELIVERY</th>
                    <th align="center">DELIVERED</th>
                    <th align="center">RTO INITIATED</th>
                    <th align="center">RTO DELIVERED</th>
                    <th align="center">Total</th>
                </tr>

                <!-- MATRIX ROWS -->
                {% for u in user_wise %}
                <tr style="border-bottom:1px solid #eee;">
                    <td>
                        <b>{{ u.name }}</b><br>
                        <small style="color:#777;">{{ u.username }}</small>
                    </td>

                    <!-- Pending -->
                    <td align="center">
                        {% for us in u.statuses %}{% if us.status == "Pending" %}{{ us.orders }}{% endif %}{% empty %}0{% endfor %}
                    </td>

                    <!-- Accepted -->
                    <td align="center">
                        {% for us in u.statuses %}{% if us.status == "Accepted" %}{{ us.orders }}{% endif %}{% empty %}0{% endfor %}
                    </td>

                    <!-- OUT FOR DELIVERY -->
                    <td align="center">
                        {% for us in u.statuses %}{% if us.status == "OUT FOR DELIVERY" %}{{ us.orders }}{% endif %}{% empty %}0{% endfor %}
                    </td>

                    <!-- DELIVERED -->
                    <td align="center">
                        {% for us in u.statuses %}{% if us.status == "DELIVERED" %}{{ us.orders }}{% endif %}{% empty %}0{% endfor %}
                    </td>

                    <!-- RTO INITIATED -->
                    <td align="center">
                        {% for us in u.statuses %}{% if us.status == "RTO INITIATED" %}{{ us.orders }}{% endif %}{% empty %}0{% endfor %}
                    </td>

                    <!-- RTO DELIVERED -->
                    <td align="center">
                        {% for us in u.statuses %}{% if us.status == "RTO DELIVERED" %}{{ us.orders }}{% endif %}{% empty %}0{% endfor %}
                    </td>

                    <!-- TOTAL -->
                    <td align="center" style="font-weight:bold;background:#f7f9fc;">
                        {{ u.total_orders }}
                    </td>
                </tr>
                {% endfor %}
            </table>

        </td>
    </tr>

    <!-- FOOTER -->
    <tr>
        <td style="background:#fafafa;padding:15px;text-align:center;
                   color:#888;font-size:12px;">
            This is an auto-generated report. Please do not reply.
        </td>
    </tr>

</table>

</td>
</tr>
</table>

</body>
</html>
